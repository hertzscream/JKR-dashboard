<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Log Dashboard - Realtime & Dark Mode</title>
    <!-- Tailwind CSS with Dark Mode Config -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: {
                            750: '#2d3748', // Custom dark shade
                            850: '#1a202c',
                            900: '#0f172a', // Darker background
                        }
                    }
                }
            }
        }
    </script>
    <!-- React & Libraries -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
    <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap');
        
        body { font-family: 'Sarabun', sans-serif; transition: background-color 0.3s, color 0.3s; }
        
        /* Glassmorphism that adapts to dark mode */
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(226, 232, 240, 0.8);
            border-radius: 1.5rem;
            transition: all 0.3s ease;
        }
        .dark .glass-card {
            background: rgba(30, 41, 59, 0.8); /* Slate-800 with opacity */
            border: 1px solid rgba(51, 65, 85, 0.5);
        }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb { background: #475569; }

        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-100">
    <div id="root"></div>

    <script>
        const { useState, useEffect, useMemo, useRef } = React;
        const e = React.createElement;
        const { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, BarChart, Bar, Cell } = window.Recharts;

        // --- SVG Icons ---
        const Icon = ({ name, className = "w-5 h-5" }) => {
            const paths = {
                upload: `<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>`,
                activity: `<polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>`,
                clock: `<circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>`,
                database: `<ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>`,
                alert: `<circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>`,
                download: `<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>`,
                moon: `<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>`,
                sun: `<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>`,
                settings: `<circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1.82.33h.09a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>`,
                refresh: `<polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>`
            };
            return e('svg', {
                dangerouslySetInnerHTML: { __html: paths[name] || '' },
                viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2",
                strokeLinecap: "round", strokeLinejoin: "round", className: className
            });
        };

        // --- Utilities ---
        const timeToSeconds = (str) => {
            if (!str || str === '-' || typeof str !== 'string') return 0;
            const parts = str.trim().split(':').map(Number);
            if (parts.length === 3) return parts[0] * 3600 + parts[1] * 60 + parts[2];
            if (parts.length === 2) return parts[0] * 60 + parts[1];
            return 0;
        };

        const secondsToHms = (s) => {
            const h = Math.floor(s / 3600);
            const m = Math.floor((s % 3600) / 60);
            const sec = s % 60;
            if (h > 0) return `${h} à¸Šà¸¡. ${m} à¸™à¸²à¸—à¸µ`;
            if (m > 0) return `${m} à¸™à¸²à¸—à¸µ ${sec} à¸§à¸´`;
            return `${sec} à¸§à¸´`;
        };

        const INITIAL_DATA = [
             { date: "27/01/2026", stop: "16:57:02", start: "16:57:20", dur: "0:00:17", cum: "0:00:17" },
             { date: "28/01/2026", stop: "10:16:15", start: "10:17:29", dur: "0:01:14", cum: "0:01:40" },
        ]; // Just a small sample

        function App() {
            const [data, setData] = useState([]);
            const [filterDate, setFilterDate] = useState('All');
            const [darkMode, setDarkMode] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [sheetUrl, setSheetUrl] = useState('');
            const [isLoading, setIsLoading] = useState(false);

            // Theme Effect
            useEffect(() => {
                if (darkMode) document.documentElement.classList.add('dark');
                else document.documentElement.classList.remove('dark');
            }, [darkMode]);

            // Load saved settings & Initial Data
            useEffect(() => {
                const savedUrl = localStorage.getItem('genLog_sheetUrl');
                if (savedUrl) {
                    setSheetUrl(savedUrl);
                    fetchSheetData(savedUrl);
                } else {
                    // Load sample data if no sheet connected
                    processData(INITIAL_DATA);
                }

                // Auto Refresh Timer (every 60s if URL exists)
                const interval = setInterval(() => {
                    if (localStorage.getItem('genLog_sheetUrl')) {
                        fetchSheetData(localStorage.getItem('genLog_sheetUrl'), true); // Silent refresh
                    }
                }, 60000);

                return () => clearInterval(interval);
            }, []);

            const processData = (rawData) => {
                const processed = rawData.map((d, i) => ({
                    ...d, id: i, durSec: timeToSeconds(d.dur), cumSec: timeToSeconds(d.cum)
                }));
                setData(processed);
            };

            const fetchSheetData = async (url, silent = false) => {
                if (!url) return;
                if (!silent) setIsLoading(true);
                try {
                    const response = await fetch(url);
                    if (!response.ok) throw new Error("Connection failed");
                    const text = await response.text();
                    
                    const rows = text.split('\n').filter(r => r.trim());
                    // Assuming row 0 is header
                    const parsed = rows.slice(1).map((row, i) => {
                        // Handle CSV parsing carefully (simple split for now)
                        const c = row.split(',').map(v => v.trim());
                        return {
                            id: i, date: c[0] || "", stop: c[1] || "", start: c[2] || "", 
                            dur: c[3] || "0:00:00", cum: c[4] || "0:00:00"
                        };
                    });
                    processData(parsed);
                } catch (err) {
                    console.error("Fetch Error:", err);
                    if (!silent) alert("à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ Google Sheet à¹„à¸”à¹‰\nà¸à¸£à¸¸à¸“à¸²à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸¥à¸´à¸‡à¸à¹Œà¹à¸¥à¸°à¸ªà¸´à¸—à¸˜à¸´à¹Œà¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡ (Publish to Web -> CSV)");
                } finally {
                    if (!silent) setIsLoading(false);
                }
            };

            const handleSaveSettings = () => {
                localStorage.setItem('genLog_sheetUrl', sheetUrl);
                fetchSheetData(sheetUrl);
                setShowSettings(false);
            };

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (evt) => {
                    const text = evt.target.result;
                    const rows = text.split('\n').filter(r => r.trim());
                    const parsed = rows.slice(1).map((row, i) => {
                        const c = row.split(',').map(v => v.trim());
                        return {
                            id: i, date: c[0], stop: c[1], start: c[2], dur: c[3], cum: c[4]
                        };
                    });
                    processData(parsed);
                    // Clear sheet url if manual upload
                    setSheetUrl('');
                    localStorage.removeItem('genLog_sheetUrl');
                };
                reader.readAsText(file);
            };

            const filteredData = useMemo(() => 
                filterDate === 'All' ? data : data.filter(d => d.date === filterDate)
            , [data, filterDate]);

            const dateOptions = useMemo(() => ['All', ...new Set(data.map(d => d.date))], [data]);

            const summary = useMemo(() => {
                const total = filteredData.reduce((acc, cur) => acc + cur.durSec, 0);
                const maxVal = Math.max(...filteredData.map(d => d.durSec), 0);
                const maxRow = filteredData.find(d => d.durSec === maxVal);
                return {
                    count: filteredData.length,
                    totalStr: secondsToHms(total),
                    avgStr: secondsToHms(Math.round(total / (filteredData.length || 1))),
                    maxStr: maxRow ? maxRow.dur : '0:00:00',
                    totalRaw: total
                };
            }, [filteredData]);

            // Recharts Theme props
            const chartStroke = darkMode ? '#94a3b8' : '#64748b';
            const gridStroke = darkMode ? '#334155' : '#e2e8f0';
            const tooltipBg = darkMode ? '#1e293b' : '#ffffff';
            const tooltipColor = darkMode ? '#f1f5f9' : '#1e293b';

            return e('div', { className: "min-h-screen pb-12 px-4 md:px-8 max-w-7xl mx-auto space-y-6 animate-fade-in relative transition-colors duration-300" }, [
                
                // --- Settings Modal ---
                showSettings && e('div', { className: "fixed inset-0 bg-black/50 z-50 flex items-center justify-center backdrop-blur-sm p-4" }, 
                    e('div', { className: "bg-white dark:bg-slate-800 p-6 rounded-2xl w-full max-w-md shadow-2xl animate-fade-in" }, [
                        e('h3', { className: "text-lg font-bold mb-4 flex items-center gap-2 dark:text-white" }, [e(Icon, {name: 'database'}), "à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­"]),
                        e('p', { className: "text-sm text-slate-500 dark:text-slate-400 mb-4" }, "à¸§à¸²à¸‡à¸¥à¸´à¸‡à¸à¹Œ Google Sheet à¸—à¸µà¹ˆà¹€à¸œà¸¢à¹à¸žà¸£à¹ˆà¹€à¸›à¹‡à¸™ CSV à¹€à¸žà¸·à¹ˆà¸­à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´"),
                        e('input', { 
                            className: "w-full p-3 border rounded-xl mb-4 text-sm dark:bg-slate-700 dark:border-slate-600 dark:text-white outline-none focus:ring-2 focus:ring-blue-500",
                            placeholder: "https://docs.google.com/.../pub?output=csv",
                            value: sheetUrl,
                            onChange: (e) => setSheetUrl(e.target.value)
                        }),
                        e('div', { className: "flex justify-end gap-2" }, [
                            e('button', { className: "px-4 py-2 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg", onClick: () => setShowSettings(false) }, "à¸¢à¸à¹€à¸¥à¸´à¸"),
                            e('button', { className: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-lg", onClick: handleSaveSettings }, "à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸¥à¸°à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥")
                        ])
                    ])
                ),

                // --- Navbar ---
                e('nav', { className: "flex justify-between items-center pt-6 mb-8" }, [
                    e('div', { className: "flex items-center gap-2" }, [
                        e('div', { className: "w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center text-white shadow-lg" }, 
                            e(Icon, { name: 'activity' })
                        ),
                        e('div', null, [
                            e('h1', { className: "font-bold text-xl leading-tight dark:text-white" }, "Gen Log"),
                            e('p', { className: "text-xs text-slate-500 dark:text-slate-400" }, "Monitoring System")
                        ])
                    ]),
                    e('div', { className: "flex items-center gap-3" }, [
                        // Refresh Button (Only if URL exists)
                        sheetUrl && e('button', { 
                            className: `p-2.5 rounded-xl border border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-800 transition ${isLoading ? 'animate-spin' : ''}`,
                            onClick: () => fetchSheetData(sheetUrl),
                            title: "à¸£à¸µà¹€à¸Ÿà¸£à¸Šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥"
                        }, e(Icon, { name: 'refresh' })),
                        // Settings Button
                        e('button', { 
                            className: "p-2.5 rounded-xl border border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-800 transition",
                            onClick: () => setShowSettings(true),
                            title: "à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­"
                        }, e(Icon, { name: 'settings' })),
                        // Dark Mode Toggle
                        e('button', { 
                            className: "p-2.5 rounded-xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-500 dark:text-yellow-400 hover:shadow-md transition",
                            onClick: () => setDarkMode(!darkMode)
                        }, e(Icon, { name: darkMode ? 'sun' : 'moon' }))
                    ])
                ]),

                // --- Controls & Stats ---
                e('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-6" }, [
                    // Date Filter (Col 1)
                    e('div', { className: "md:col-span-1" }, [
                        e('select', { 
                            className: "w-full p-4 rounded-2xl bg-white dark:bg-slate-800 dark:text-white border border-slate-200 dark:border-slate-700 shadow-sm outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer",
                            value: filterDate,
                            onChange: (e) => setFilterDate(e.target.value)
                        }, dateOptions.map(d => e('option', { key: d, value: d }, d === 'All' ? 'ðŸ“… à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸¸à¸à¸§à¸±à¸™' : `ðŸ“… à¸§à¸±à¸™à¸—à¸µà¹ˆ ${d}`)))
                    ]),
                    // File Upload (Col 2)
                    e('label', { className: "md:col-span-1 cursor-pointer group" }, [
                        e('div', { className: "w-full p-4 rounded-2xl bg-white dark:bg-slate-800 border border-dashed border-slate-300 dark:border-slate-600 flex items-center justify-center gap-3 text-slate-500 dark:text-slate-400 hover:border-blue-500 hover:text-blue-500 transition shadow-sm" }, [
                            e(Icon, { name: 'upload' }), 
                            e('span', { className: "font-medium" }, "à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¹„à¸Ÿà¸¥à¹Œ CSV")
                        ]),
                        e('input', { type: 'file', className: "hidden", accept: ".csv", onChange: handleFileUpload })
                    ]),
                    // Stats Summary (Col 3-4)
                    e('div', { className: "md:col-span-2 grid grid-cols-2 gap-4" }, [
                        e('div', { className: "bg-blue-600 rounded-2xl p-4 text-white shadow-lg shadow-blue-200 dark:shadow-none flex flex-col justify-between" }, [
                            e('div', { className: "flex justify-between items-start" }, [
                                e('span', { className: "text-blue-100 text-xs font-bold uppercase" }, "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸”à¸±à¸šà¸£à¸§à¸¡"),
                                e(Icon, { name: 'activity', className: "opacity-50" })
                            ]),
                            e('h3', { className: "text-2xl font-bold mt-2" }, summary.count + " à¸„à¸£à¸±à¹‰à¸‡")
                        ]),
                        e('div', { className: "bg-white dark:bg-slate-800 rounded-2xl p-4 border border-slate-200 dark:border-slate-700 shadow-sm flex flex-col justify-between" }, [
                            e('div', { className: "flex justify-between items-start" }, [
                                e('span', { className: "text-slate-400 text-xs font-bold uppercase" }, "à¹€à¸§à¸¥à¸²à¸£à¸§à¸¡"),
                                e(Icon, { name: 'clock', className: "text-rose-500" })
                            ]),
                            e('h3', { className: "text-2xl font-bold mt-2 dark:text-white" }, summary.totalStr)
                        ])
                    ])
                ]),

                // --- Charts ---
                e('div', { className: "grid grid-cols-1 lg:grid-cols-3 gap-6" }, [
                    // Main Area Chart
                    e('div', { className: "lg:col-span-2 glass-card p-6" }, [
                        e('h3', { className: "font-bold text-slate-800 dark:text-white mb-6 flex items-center gap-2" }, [
                            e('span', { className: "w-2 h-6 bg-blue-500 rounded-full" }), "à¹à¸™à¸§à¹‚à¸™à¹‰à¸¡à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²à¸à¸²à¸£à¸«à¸¢à¸¸à¸”à¸—à¸³à¸‡à¸²à¸™ (Timeline)"
                        ]),
                        e('div', { className: "h-[300px] w-full" }, e(ResponsiveContainer, null, e(AreaChart, { data: filteredData }, [
                            e('defs', { key: 'defs' }, 
                                e('linearGradient', { id: "colorDur", x1: "0", y1: "0", x2: "0", y2: "1" }, [
                                    e('stop', { offset: "5%", stopColor: "#3b82f6", stopOpacity: 0.3 }),
                                    e('stop', { offset: "95%", stopColor: "#3b82f6", stopOpacity: 0 })
                                ])
                            ),
                            e(CartesianGrid, { strokeDasharray: "3 3", vertical: false, stroke: gridStroke }),
                            e(XAxis, { dataKey: "stop", fontSize: 10, tick: {fill: chartStroke}, axisLine: false }),
                            e(YAxis, { fontSize: 10, tick: {fill: chartStroke}, axisLine: false }),
                            e(Tooltip, { 
                                contentStyle: { backgroundColor: tooltipBg, borderRadius: '12px', border: 'none', boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)', color: tooltipColor },
                                itemStyle: { color: tooltipColor },
                                formatter: (v) => [secondsToHms(v), "à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²"]
                            }),
                            e(Area, { type: "monotone", dataKey: "durSec", stroke: "#3b82f6", strokeWidth: 3, fill: "url(#colorDur)" })
                        ])))
                    ]),
                    // Cumulative Bar Chart
                    e('div', { className: "glass-card p-6" }, [
                        e('h3', { className: "font-bold text-slate-800 dark:text-white mb-2" }, "à¸ªà¸£à¸¸à¸›à¸£à¸²à¸¢à¸§à¸±à¸™"),
                        e('p', { className: "text-xs text-slate-400 mb-6" }, "à¸£à¸§à¸¡à¹€à¸§à¸¥à¸²à¸”à¸±à¸šà¹à¸¢à¸à¸•à¸²à¸¡à¸§à¸±à¸™"),
                        e('div', { className: "h-[300px] w-full" }, e(ResponsiveContainer, null, e(BarChart, { 
                            data: dateOptions.filter(d => d !== 'All').map(d => ({
                                date: d,
                                total: data.filter(row => row.date === d).reduce((a, b) => a + b.durSec, 0)
                            }))
                        }, [
                            e(XAxis, { dataKey: "date", fontSize: 10, tick: {fill: chartStroke}, axisLine: false }),
                            e(Tooltip, { 
                                cursor: {fill: 'transparent'},
                                contentStyle: { backgroundColor: tooltipBg, borderRadius: '12px', border: 'none', color: tooltipColor },
                                itemStyle: { color: tooltipColor },
                                formatter: (v) => [secondsToHms(v), "à¹€à¸§à¸¥à¸²à¸£à¸§à¸¡"]
                            }),
                            e(Bar, { dataKey: "total", radius: [6, 6, 0, 0] }, [
                                e(Cell, { fill: "#3b82f6" }), e(Cell, { fill: "#f59e0b" })
                            ])
                        ])))
                    ])
                ]),

                // --- Detailed Table ---
                e('div', { className: "glass-card overflow-hidden" }, [
                    e('div', { className: "p-6 border-b border-slate-100 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50 flex justify-between items-center" }, [
                        e('h3', { className: "font-bold text-slate-800 dark:text-white" }, "à¸šà¸±à¸™à¸—à¸¶à¸à¹€à¸«à¸•à¸¸à¸à¸²à¸£à¸“à¹Œ (Detailed Log)"),
                        e('button', { className: "text-xs font-bold text-blue-600 hover:underline flex items-center gap-1", onClick: () => window.print() }, [e(Icon, {name: 'download'}), "à¸žà¸´à¸¡à¸žà¹Œà¸£à¸²à¸¢à¸‡à¸²à¸™"])
                    ]),
                    e('div', { className: "overflow-x-auto custom-scrollbar" }, e('table', { className: "w-full text-left" }, [
                        e('thead', { className: "bg-slate-50 dark:bg-slate-800 text-[10px] text-slate-400 uppercase font-bold tracking-widest" }, e('tr', null, 
                            ['à¸§à¸±à¸™à¸—à¸µà¹ˆ', 'à¹€à¸§à¸¥à¸²à¸”à¸±à¸š', 'à¹€à¸§à¸¥à¸²à¸•à¸´à¸”', 'à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²', 'à¸ªà¸°à¸ªà¸¡', 'à¸ªà¸–à¸²à¸™à¸°'].map(h => e('th', { key: h, className: "px-6 py-4 font-semibold" }, h))
                        )),
                        e('tbody', { className: "text-sm divide-y divide-slate-100 dark:divide-slate-700" }, filteredData.map(r => e('tr', { key: r.id, className: "hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors" }, [
                            e('td', { className: "px-6 py-4 font-medium text-slate-700 dark:text-slate-200" }, r.date),
                            e('td', { className: "px-6 py-4 text-slate-500 dark:text-slate-400" }, r.stop),
                            e('td', { className: "px-6 py-4 text-slate-500 dark:text-slate-400" }, r.start),
                            e('td', { className: "px-6 py-4" }, e('span', { className: "font-bold text-rose-500" }, r.dur)),
                            e('td', { className: "px-6 py-4 font-bold text-blue-600 dark:text-blue-400" }, r.cum),
                            e('td', { className: "px-6 py-4" }, e('span', { 
                                className: `px-2 py-1 rounded-md text-[10px] font-bold uppercase ${r.durSec > 300 ? 'bg-rose-100 text-rose-600 dark:bg-rose-900/30 dark:text-rose-400' : r.durSec > 60 ? 'bg-amber-100 text-amber-600 dark:bg-amber-900/30 dark:text-amber-400' : 'bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400'}` 
                            }, r.durSec > 300 ? 'Critical' : r.durSec > 60 ? 'Warning' : 'Normal'))
                        ])))
                    ]))
                ]),

                // --- Footer ---
                e('footer', { className: "text-center pt-8 border-t border-slate-200 dark:border-slate-700" }, [
                    e('p', { className: "text-[10px] text-slate-400 uppercase" }, "Generator Monitoring System v3.0 - Realtime & Dark Mode")
                ])
            ]);
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(e(App));
    </script>
</body>
</html>
